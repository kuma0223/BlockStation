<!DOCTYPE html>
<html lang="ja">
<head>
    <title>サービス呼び出しテスト用ページ</title>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width" />

    <style type="text/css">
        html {
            background: linear-gradient(to bottom, #f5ffff, #90bced 100%);
            background-attachment: fixed;
        }
        * {
            font-family: Meiryo;
            font-size: 16px;
        }
    </style>

    <script type="text/javascript" src="__auth.js"></script>
</head>

<body>
    <div>
        <div>URL</div>
        <div>
            <input type="text" style="width: 600px;" id="urltext" value="api/" />
        </div>
        <div style="margin-top:10px;">Header</div>
        <div>
            <textarea style="height: 5em; width: 600px;" id="headtext"></textarea>
        </div>
        <div style="margin-top:10px;">Body</div>
        <div>
            <textarea style="height: 10em; width: 600px;" id="bodytext"></textarea>
        </div>
        <div style="margin-top: 5px;">
            <button onclick="GetClick()">GET</button>
            <button onclick="PostClick()">POST</button>
        </div>

        <div style="margin-top:20px;">
            <input type="text" style="width: 100px;" id="usertext" value="" placeholder="user" />
            <input type="text" style="width: 100px;" id="passtext" value="" placeholder="password" />
            <button onclick="LoginClick()">LOGIN</button>
            <button onclick="LogoutClick()">LOGOUT</button>
        </div>

        <div style="margin-top: 20px;">
            <div>Response Code</div>
            <div id="status" style="background: white; width:300px;">&nbsp;</div>

            <div style="margin-top:10px;">Response Body</div>
            <div>
                <textarea style="margin-top: 5px; height: 10em; width: 600px;" id="response"></textarea>
            </div>
        </div>
    </div>

    <footer></footer>

    <script type="text/javascript">
        onload = function () {
            document.getElementById("urltext").value = localStorage.getItem("urltext");
            document.getElementById("bodytext").value = localStorage.getItem("bodytext");
            document.getElementById("headtext").value = localStorage.getItem("headtext");
        }

        async function GetClick() {
            var url = document.getElementById("urltext").value;
            var body = document.getElementById("bodytext").value;
            var head = document.getElementById("headtext").value;
            localStorage.setItem("urltext", url);
            localStorage.setItem("bodytext", body);
            localStorage.setItem("headtext", head);

            var param = {
                type: "GET",
                url: url,
            }
            Auth.ajax(param).then(event => {
                document.getElementById("status").textContent = event.status;
                document.getElementById("response").value = event.body;
            })
        }

        function PostClick() {
            var url = document.getElementById("urltext").value;
            var body = document.getElementById("bodytext").value;
            var head = document.getElementById("headtext").value;
            localStorage.setItem("urltext", url);
            localStorage.setItem("bodytext", body);
            localStorage.setItem("headtext", head);

            var param = {
                method: "POST",
                body: JSON.parse(body),
                url: url,
            }
            Auth.ajax(param).then(event => {
                document.getElementById("status").textContent = event.status;
                document.getElementById("response").value = event.body;
            })
        }

        function LoginClick() {
            var user = document.getElementById("usertext").value;
            var pass = document.getElementById("passtext").value;

            Auth.login(user, pass, false).then(event => {
                document.getElementById("status").textContent = event.status;
            })
        }

        function LogoutClick() {
            Auth.logout()
        }
    </script>
</body>

</html>
